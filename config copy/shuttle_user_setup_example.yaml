# Example Shuttle User Setup Configuration
# This file demonstrates various configuration options
---
version: "1.0"
metadata:
  description: "Example shuttle user setup configuration"
  environment: "production"
  created: "2025-01-01"

settings:
  create_home_directories: true
  backup_existing_users: true
  validate_before_apply: true

groups:
  shuttle_app_users:
    description: "Users who run shuttle application"
  shuttle_test_users:
    description: "Users who run defender tests"
  shuttle_samba_users:
    description: "Users who access via Samba"
  shuttle_config_readers:
    description: "Users who can read config files"
  shuttle_ledger_writers:
    description: "Users who can write to ledger"

---
# Example 1: Single user does everything
type: "user"
user:
  name: "shuttle_all"
  source: "local"  # local|domain|existing
  account_type: "service"  # service|interactive
  shell: "/usr/sbin/nologin"
  home_directory: "/var/lib/shuttle"
  create_home: true
  
  groups:
    primary: "shuttle_app_users"
    secondary: ["shuttle_test_users", "shuttle_samba_users", "shuttle_config_readers", "shuttle_ledger_writers"]
  
  capabilities:
    executables: ["run-shuttle", "run-defender-test"]
  
  permissions:
    read_write:
      - path: "source_path"
        mode: "755"
        recursive: true
      - path: "destination_path"
        mode: "755"
        recursive: true
      - path: "quarantine_path"
        mode: "755"
        recursive: true
      - path: "log_path"
        mode: "755"
        recursive: true
      - path: "hazard_archive_path"
        mode: "755"
        recursive: true
      - path: "ledger_file_path"
        mode: "644"
      - path: "test_work_dir"
        mode: "755"
        recursive: true
    read_only:
      - path: "hazard_encryption_key_path"
        mode: "644"
      - path: "shuttle_config_path"
        mode: "644"
      - path: "test_config_path"
        mode: "644"
  
  samba:
    enabled: true

# Uncomment sections below for different scenarios:

# ---
# # Example 2: Separate Samba user
# type: "user"
# user:
#   name: "samba_only"
#   source: "domain"
#   account_type: "service"
#   shell: "/usr/sbin/nologin"
#   home_directory: "/var/lib/shuttle/samba"
#   
#   groups:
#     primary: "shuttle_samba_users"
#     secondary: ["shuttle_config_readers"]
#   
#   capabilities:
#     executables: []
#   
#   permissions:
#     read_write:
#       - path: "source_path"
#         mode: "755"
#     read_only:
#       - path: "shuttle_config_path"
#         mode: "644"
#   
#   samba:
#     enabled: true

# ---
# # Example 3: Developer account
# type: "user"
# user:
#   name: "dev_user"
#   source: "local"
#   account_type: "interactive"
#   shell: "/bin/bash"
#   home_directory: "/home/dev_user"
#   create_home: true
#   
#   groups:
#     primary: "shuttle_app_users"
#     secondary: ["shuttle_test_users", "shuttle_config_readers", "shuttle_ledger_writers"]
#   
#   capabilities:
#     executables: ["run-shuttle", "run-defender-test"]
#   
#   permissions:
#     read_write:
#       - path: "source_path"
#         mode: "755"
#         recursive: true
#       - path: "test_work_dir"
#         mode: "755"
#         recursive: true